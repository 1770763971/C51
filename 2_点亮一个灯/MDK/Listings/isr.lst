C51 COMPILER V9.57.0.0   ISR                                                               03/06/2020 21:43:37 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE ISR
OBJECT MODULE PLACED IN .\Objects\isr.obj
COMPILER INVOKED BY: C:\Program\Keil_v5\C51\BIN\C51.EXE ..\USER\isr.c OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\..\Librari
                    -es\Common;..\..\Libraries\Libraries;..\CODE;..\USER) DEBUG PRINT(.\Listings\isr.lst) OBJECT(.\Objects\isr.obj)

line level    source

   1          //中断函数，中断初始化在底下
   2          
   3          #include <Main.h>
   4          #include "isr.h"
   5          
   6          sbit k3=P3^2;  //定义按键K3
   7          sbit led=P2^0;   //定义P20口是led
   8          
   9          /*******************************************************************************
  10          * 函 数 名         : Int0()     interrupt 0
  11          * 函数功能                 : 外部中断0的中断函数
  12          * 输    入         : 无
  13          * 输    出         : 无
  14          *******************************************************************************/
  15          
  16          void Int0_IRQ(void)     interrupt 0             //外部中断0的中断函数
  17          
  18          {
  19   1              delay(1000);     //延时消抖
  20   1              if(k3==0)
  21   1              {
  22   2                      led=~led;
  23   2              }
  24   1      }
  25          
  26          
  27          
  28          /*******************************************************************************
  29          * 函 数 名         : void Timer0() interrupt 1
  30          * 函数功能                 : 定时器0中断函数
  31          * 输    入         : 无
  32          * 输    出         : 无
  33          *******************************************************************************/
  34          
  35          void Timer0_IRQ(void) interrupt 1
  36          {
  37   1              
  38   1      }
  39          
  40          
  41          /*******************************************************************************
  42          * 函 数 名         : Int1()     interrupt 2
  43          * 函数功能                 : 外部中断1的中断函数
  44          * 输    入         : 无
  45          * 输    出         : 无
  46          *******************************************************************************/
  47          
  48          void Int1_IRQ(void)     interrupt 2             //外部中断1的中断函数
  49          {
  50   1      
  51   1      }
  52          
  53          
  54          /*******************************************************************************
C51 COMPILER V9.57.0.0   ISR                                                               03/06/2020 21:43:37 PAGE 2   

  55          * 函 数 名         : void Timer1() interrupt 3
  56          * 函数功能                 : 定时器1中断函数
  57          * 输    入         : 无
  58          * 输    出         : 无
  59          *******************************************************************************/
  60          void Timer1_IRQ(void) interrupt 3
  61          {
  62   1      
  63   1      }
  64          /*******************************************************************************
  65          * 函数名         : Usart() interrupt 4
  66          * 函数功能                : 串口通信中断函数
  67          * 输入           : 无
  68          * 输出           : 无
  69          *******************************************************************************/
  70          #define Self_Define_ISP_Download_Command 0x3D            // 与不断电下载有关,与本程序无关，直接复制到自己的程序中
  71          sfr IAP_CONTR=0xE7;                                                                      // 与不断电下载有关，与本程序无关，直接复制到自己的程序中
  72          void Usart() interrupt 4
  73          {
  74   1              unsigned char k=0;
  75   1              unsigned int a,b;
  76   1              if(RI==1)
  77   1              {
  78   2                      RI=0;
  79   2                      k=SBUF;
  80   2                      if(k==Self_Define_ISP_Download_Command)
  81   2                      {
  82   3                              for(a=1000;a>0;a--)
  83   3                                      for(b=100;b>0;b--); 
  84   3                              IAP_CONTR = 0x60;
  85   3                      }
  86   2              }
  87   1              else
  88   1              {
  89   2                      TI=0;
  90   2              }
  91   1      }
  92          
  93          
  94          
  95          
  96          
  97          
  98          
  99          /*******************************************************************************
 100          * 函 数 名         : Int1Init()
 101          * 函数功能                 : 设置外部中断0
 102          * 输    入         : 无
 103          * 输    出         : 无
 104          *******************************************************************************/
 105          void Int0Init(void)
 106          {
 107   1              //设置INT0
 108   1              IT0=1;//跳变沿出发方式（下降沿）
 109   1              EX0=1;//打开INT0的中断允许。    
 110   1              EA=1;//打开总中断       
 111   1      }
 112          
 113          
 114          /*******************************************************************************
 115          * 函 数 名         : Timer0Init
 116          * 函数功能                 : 定时器0初始化
C51 COMPILER V9.57.0.0   ISR                                                               03/06/2020 21:43:37 PAGE 3   

 117          * 输    入         : 无
 118          * 输    出         : 无
 119          *******************************************************************************/
 120          void Timer0Init(void)
 121          {
 122   1              TMOD|=0X01;//选择为定时器0模式，工作方式1，仅用TR0打开启动。
 123   1              TH0=0XFC;       //给定时器赋初值，定时1ms
 124   1              TL0=0X18;       
 125   1              ET0=1;//打开定时器0中断允许
 126   1              EA=1;//打开总中断
 127   1              TR0=1;//打开定时器                      
 128   1      }
 129          
 130          
 131          /*******************************************************************************
 132          * 函 数 名         : Int1Init()
 133          * 函数功能                 : 设置外部中断1
 134          * 输    入         : 无
 135          * 输    出         : 无
 136          *******************************************************************************/
 137          void Int1Init(void)
 138          {
 139   1              //设置INT1
 140   1              IT1=1;//跳变沿出发方式（下降沿）
 141   1              EX1=1;//打开INT1的中断允许。    
 142   1              EA=1;//打开总中断       
 143   1      }
 144          
 145          
 146          
 147          /*******************************************************************************
 148          * 函 数 名         : Timer1Init
 149          * 函数功能                 : 定时器1初始化
 150          * 输    入         : 无
 151          * 输    出         : 无
 152          *******************************************************************************/
 153          void Timer1Init(void)
 154          {
 155   1              TMOD|=0X10;//选择为定时器1模式，工作方式1，仅用TR1打开启动。
 156   1      
 157   1              TH1=0XFC;       //给定时器赋初值，定时1ms
 158   1              TL1=0X18;       
 159   1              ET1=1;//打开定时器1中断允许
 160   1              EA=1;//打开总中断
 161   1              TR1=1;//打开定时器                      
 162   1      }
 163          
 164          
 165          /*******************************************************************************
 166          * 函数名         :UsartInit()
 167          * 函数功能                 :设置串口
 168          * 输入           : 无
 169          * 输出           : 无
 170          *******************************************************************************/
 171          void UsartInit()
 172          {
 173   1           TMOD = 0x20;
 174   1           SM0=0;
 175   1           SM1=1;
 176   1               REN=1;
 177   1           TH1 = 0xFd;
 178   1           TL1 = 0xFd;
C51 COMPILER V9.57.0.0   ISR                                                               03/06/2020 21:43:37 PAGE 4   

 179   1           TR1 = 1;
 180   1               EA=1;
 181   1               ES=1;
 182   1      }
 183          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    225    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
